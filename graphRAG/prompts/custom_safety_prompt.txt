Goal
----
Produce a clean, auditable safety knowledge graph with normalized entities,
short descriptions, and canonical relation types.

Quality Bar
-----------
1. Use evidence-only extraction. If the text does not explicitly support a node
   or edge, omit it instead of guessing.
2. Entity surface form: uppercase, <= 4 words, no stop-words (THE, A, OF).
3. Always leverage the structured sections supplied in the input
   (`INCIDENT_LABEL`, `INCIDENT_ID`, `NARRATIVE`, `ENTITY_FACTS`, `META_FACTS`).
4. `INCIDENT_LABEL` is the canonical name for the incident node. Use it exactly
   as given (e.g., `NEAR MISS 29857 - DROPPED PRY BAR`) when creating
   `INCIDENT_TYPE` entities.
5. Draw candidates for equipment, injuries, body parts, organizations, locations,
   and dates from `ENTITY_FACTS`.
6. NEVER create entities or relationships from `META_FACTS` (severity, likelihood,
   risk color, source system, business unit, etc.)â€”treat those lines strictly as context.
7. Skip generic placeholders like "INCIDENT", "WORKPLACE", "EMPLOYEE", "CASE".
8. Prefer domain nouns over adjectives (e.g., "FORKLIFT" not "HEAVY").
9. The input escapes real line breaks as literal `\n`. Interpret `\n` as a newline
   while reading, but never emit `\n` as an entity or relation.

Entity Construction
-------------------
- entity_name: uppercase alias, <= 4 words, normalized via the table below.
- entity_type: one of {entity_types}.
- entity_description: 5-12 words describing the role or attributes. Mention
  severity, laterality (left/right), or function if it reduces ambiguity.
- For incident nodes, reuse the provided `INCIDENT_LABEL`.
- Enforce normalization (examples):
  * stairs, stairway, staircase -> STAIRS
  * forklift, lift truck, 20T forklift -> FORKLIFT
  * crane, overhead crane -> CRANE
  * left/right hands, fingers -> HAND / FINGER (side in description)
  * burns, scald -> BURN
- DATE entities must reuse ISO-like text strings from `ENTITY_FACTS` (no reformatting).

Relation Construction
---------------------
Allowed relation types only:
- CAUSED_BY: `INCIDENT_TYPE` or `INJURY_TYPE` caused by `EQUIPMENT`, `TASK`, or
  another `INCIDENT_TYPE`.
- RESULTED_IN: `INCIDENT_TYPE` leading to an `INJURY_TYPE`.
- INVOLVED: `INCIDENT_TYPE` referencing equipment, organization, or supporting
  teams directly engaged in the event.
- OCCURRED_AT: `INCIDENT_TYPE` anchored to `LOCATION` or `DATE`.
- AFFECTED: `INJURY_TYPE` -> `BODY_PART`.
- USED_IN: `INCIDENT_TYPE` or `TASK` -> `EQUIPMENT` that was intentionally used.

Strength scoring: 10 = explicit cause/effect, 8 = strong textual evidence,
5 = contextual co-location only.

Formatting
----------
Entity tuple:
("entity"{tuple_delimiter}<entity_name>{tuple_delimiter}<entity_type>{tuple_delimiter}<entity_description>)

Relationship tuple:
("relationship"{tuple_delimiter}<source>{tuple_delimiter}<target>{tuple_delimiter}<relation_type>{tuple_delimiter}<strength>)

Separate tuples with {record_delimiter} and end the entire response with {completion_delimiter}.

Example
-------
Text:
INCIDENT_LABEL: ACCIDENT 324 - 20Ton Forklift dented parking delivery truck
INCIDENT_ID: 324
NARRATIVE:
20T Forklift was transporting offshore cabin basket, while reversing for a 3 point
turning the forklift collided into the DHL Truck in the parking area causing a small
dent on the backside of the truck. No one was injured.

ENTITY_FACTS:
- INCIDENT_TYPE: Accident
- IMPACT_TYPE: Damage - Financial impact
- SEVERITY_DESC: 2 - Minor
- LIKELIHOOD_DESC: Frequency of the incident
- LIKELIHOOD_RANGE: 3 - Possible - Has occurred in our company, or more than once per year in the industry
- EVENT_DATETIME: 20:00.0
- WORKPLACE: Nusajaya Campus 2, Iskandar Puteri, Malaysia, Asia Pacific, TechnipFMC
- CLIENT: TECHNIPFMC PLC
- WORK_PROCESS: Manufacturing-Warehouse
- REPORTED_DATE: 1/11/2022
- OPERATING_CENTER: N/A - Non Project Specific

META_FACTS:
- META[RISK_COLOR]: Green
- META[MITIGATED_RISK]: 2.0
- META[TITLE]: 20Ton Forklift dented parking delivery truck
- META[GENERAL_BUSINESS_UNIT]: REMS
- META[SPECIFIC_BUSINESS_UNIT]: Surface Products
- META[PROJECT]: N/A - Non Project Specific - N/A - Non Project Specific
- META[CASE_CATEGORIZATION]: Workplace layout / congestion
- META[LIFE_SAVING_RULES]: Driving - Follow safe driving rules
- META[LOSS_POTENTIAL]: 2.0
- META[LOCATION_CODE]: TFMC408
- META[WORK_RELATIONSHIP]: Work related case
- META[TFMC_OWNERSHIP]: TFMC owned operation

Output:
("entity"{tuple_delimiter}ACCIDENT 324 - 20TON FORKLIFT DENTED PARKING DELIVERY TRUCK{tuple_delimiter}INCIDENT_TYPE{tuple_delimiter}Forklift struck parked truck)
{record_delimiter}
("entity"{tuple_delimiter}FORKLIFT{tuple_delimiter}EQUIPMENT{tuple_delimiter}20T forklift reversing during turn)
{record_delimiter}
("entity"{tuple_delimiter}DHL TRUCK{tuple_delimiter}EQUIPMENT{tuple_delimiter}Parked delivery truck that was hit)
{record_delimiter}
("entity"{tuple_delimiter}NUSAJAYA CAMPUS 2{tuple_delimiter}LOCATION{tuple_delimiter}Malaysia facility where impact occurred)
{record_delimiter}
("entity"{tuple_delimiter}2022-01-11{tuple_delimiter}DATE{tuple_delimiter}Incident report date)
{record_delimiter}
("relationship"{tuple_delimiter}ACCIDENT 324 - 20TON FORKLIFT DENTED PARKING DELIVERY TRUCK{tuple_delimiter}FORKLIFT{tuple_delimiter}INVOLVED{tuple_delimiter}8)
{record_delimiter}
("relationship"{tuple_delimiter}ACCIDENT 324 - 20TON FORKLIFT DENTED PARKING DELIVERY TRUCK{tuple_delimiter}DHL TRUCK{tuple_delimiter}INVOLVED{tuple_delimiter}5)
{record_delimiter}
("relationship"{tuple_delimiter}ACCIDENT 324 - 20TON FORKLIFT DENTED PARKING DELIVERY TRUCK{tuple_delimiter}NUSAJAYA CAMPUS 2{tuple_delimiter}OCCURRED_AT{tuple_delimiter}10)
{record_delimiter}
("relationship"{tuple_delimiter}ACCIDENT 324 - 20TON FORKLIFT DENTED PARKING DELIVERY TRUCK{tuple_delimiter}2022-01-11{tuple_delimiter}OCCURRED_AT{tuple_delimiter}5)
{completion_delimiter}

Real Data
---------
Entity_types: {entity_types}
Text: {input_text}
Output:
